/* react-diff-view default styles */
@import 'react-diff-view/style/index.css';

/* ─── react-diff-view CSS variable overrides ─── */
:root {
  --diff-background-color:             var(--diff-bg);
  --diff-text-color:                   var(--diff-text);
  --diff-selection-background-color:   var(--diff-selection-bg);
  --diff-gutter-insert-background-color: var(--diff-insert-gutter);
  --diff-gutter-delete-background-color: var(--diff-delete-gutter);
  --diff-code-insert-background-color:   var(--diff-insert-bg);
  --diff-code-delete-background-color:   var(--diff-delete-bg);
  --diff-code-insert-edit-background-color: var(--diff-insert-edit-bg);
  --diff-code-delete-edit-background-color: var(--diff-delete-edit-bg);
  --diff-gutter-selected-background-color: var(--diff-gutter-selected);
  --diff-code-selected-background-color:   var(--diff-selection-bg);
}

/* ─── Diff viewer base ─── */
.diff-view {
  background-color: var(--diff-bg);
  color: var(--diff-text);
  font-family: 'Geist Mono', ui-monospace, 'Fira Code', monospace;
  font-size: 13px;
  line-height: 1.5;
}

/* ─── Gutter ─── */
.diff-gutter {
  background-color: var(--diff-gutter-bg);
  color: var(--ctp-overlay0);
  border-right: 1px solid var(--ctp-surface1);
  min-width: 50px;
  padding: 0 8px;
  text-align: right;
  user-select: none;
  cursor: pointer;
  position: relative;
  overflow: visible;
  transition: background-color 0.15s, color 0.15s;
}

.diff-gutter:hover {
  background-color: color-mix(in srgb, var(--ctp-peach) 12%, var(--diff-gutter-bg));
  color: var(--ctp-peach);
}

.diff-gutter-col {
  background-color: var(--diff-gutter-bg);
}

/* ─── Lines ─── */
.diff-line {
  background-color: var(--diff-bg);
}

.diff-line-insert {
  background-color: var(--diff-insert-bg);
}

.diff-line-delete {
  background-color: var(--diff-delete-bg);
}

/* ─── Code cells ─── */
.diff-code {
  padding-left: 12px;
  white-space: pre-wrap;
  word-break: break-all;
}

.diff-code-insert {
  background-color: var(--diff-insert-bg);
}

.diff-code-delete {
  background-color: var(--diff-delete-bg);
}

/* ─── Hunk header ─── */
.diff-hunk-header {
  background-color: var(--ctp-surface0);
  color: var(--ctp-subtext);
  padding: 4px 12px;
  font-weight: 600;
  border-top: 1px solid var(--ctp-surface1);
  border-bottom: 1px solid var(--ctp-surface1);
}

/* ─── Selection ─── */
.diff td.diff-gutter-selected {
  background-color: var(--diff-gutter-selected) !important;
}

.diff td.diff-code-selected {
  background-color: var(--diff-selection-bg) !important;
}

/* ─── Split view ─── */
.diff-view-split .diff-gutter {
  min-width: 45px;
}

.diff-view-split .diff-table {
  width: 100%;
  table-layout: fixed;
}

.diff-view-split .diff-table td {
  width: 50%;
}

.diff-split {
  table-layout: fixed;
}

/* Constrain text selection to one column in split view */
table.diff-split[data-selecting="old"] td:nth-child(n+3) {
  user-select: none !important;
  -webkit-user-select: none !important;
}
table.diff-split[data-selecting="new"] td:nth-child(-n+2) {
  user-select: none !important;
  -webkit-user-select: none !important;
}

/* ─── Widget rows ─── */
.diff-widget {
  background-color: transparent;
}

.diff-widget-content .split-widget-old,
.diff-widget-content .split-widget-new {
  width: 100%;
}

td[colspan="4"].diff-widget-content .split-widget-old {
  width: 50%;
}

td[colspan="4"].diff-widget-content .split-widget-new {
  width: 50%;
  margin-left: 50%;
}

/* ─── Decoration rows (expand context) ─── */
.diff-decoration {
  background-color: transparent;
}

.diff-decoration-gutter {
  background-color: var(--diff-gutter-bg);
  border-right: 1px solid var(--ctp-surface1);
}

.diff-decoration-content {
  background-color: transparent;
}

/* ─── Search highlights ─── */
.search-match {
  background-color: color-mix(in srgb, var(--ctp-yellow) 35%, transparent);
  border-radius: 2px;
}

.search-match-current {
  background-color: color-mix(in srgb, var(--ctp-peach) 50%, transparent);
  border-radius: 2px;
  outline: 1px solid color-mix(in srgb, var(--ctp-peach) 70%, transparent);
}

.word-highlight {
  background-color: color-mix(in srgb, var(--ctp-yellow) 35%, transparent);
  border-radius: 2px;
}
