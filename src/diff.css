/* react-diff-view default styles */
@import 'react-diff-view/style/index.css';

/* Override react-diff-view CSS variables for dark theme */
:root {
  --diff-background-color: #1f2937;
  --diff-text-color: #f3f4f6;
  --diff-selection-background-color: #3b82f6;
  --diff-gutter-insert-background-color: rgba(22, 101, 52, 0.3);
  --diff-gutter-delete-background-color: rgba(153, 27, 27, 0.3);
  --diff-code-insert-background-color: rgba(22, 101, 52, 0.25);
  --diff-code-delete-background-color: rgba(153, 27, 27, 0.25);
  --diff-code-insert-edit-background-color: rgba(34, 197, 94, 0.2);
  --diff-code-delete-edit-background-color: rgba(239, 68, 68, 0.2);
  --diff-gutter-selected-background-color: rgba(59, 130, 246, 0.2);
  --diff-code-selected-background-color: rgba(59, 130, 246, 0.15);
}

/* Custom dark theme overrides */
.diff-view {
  @apply bg-gray-800 text-gray-100;
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
  font-size: 13px;
  line-height: 1.5;
}

.diff-gutter {
  @apply bg-gray-900 text-gray-500;
  border-right: 1px solid #374151;
  min-width: 50px;
  padding: 0 8px;
  text-align: right;
  user-select: none;
  cursor: pointer;
  transition: background-color 0.2s, color 0.2s;
}

.diff-gutter:hover {
  @apply bg-blue-900/30 text-blue-400;
}

.diff-gutter-col {
  @apply bg-gray-900;
}

.diff-line {
  @apply bg-gray-800;
}

.diff-line-insert {
  @apply bg-green-900/30;
}

.diff-line-delete {
  @apply bg-red-900/30;
}

.diff-code {
  padding-left: 12px;
  white-space: pre-wrap;
  word-break: break-all;
}

.diff-code-insert {
  @apply bg-green-900/40;
}

.diff-code-delete {
  @apply bg-red-900/40;
}

.diff-hunk-header {
  @apply bg-gray-700 text-gray-300;
  padding: 4px 12px;
  font-weight: 600;
  border-top: 1px solid #4b5563;
  border-bottom: 1px solid #4b5563;
}

/* Split view specific */
.diff-view-split .diff-gutter {
  min-width: 45px;
}

.diff-view-split .diff-table {
  width: 100%;
  table-layout: fixed;
}

.diff-view-split .diff-table td {
  width: 50%;
}

/* Split view layout */
.diff-split {
  table-layout: fixed;
}

/* Constrain text selection to one column in split view */
table.diff-split[data-selecting="old"] td:nth-child(n+3) {
  user-select: none !important;
  -webkit-user-select: none !important;
}
table.diff-split[data-selecting="new"] td:nth-child(-n+2) {
  user-select: none !important;
  -webkit-user-select: none !important;
}

/* Highlight lines when hovering or selecting a range */
.diff td.diff-gutter-selected {
  background-color: rgba(59, 130, 246, 0.28) !important;
}

.diff td.diff-code-selected {
  background-color: rgba(59, 130, 246, 0.2) !important;
}

/* Inline comment/form widget rows */
.diff-widget {
  background-color: transparent;
}

/* Gutter needs relative positioning for the comment button */
.diff-gutter {
  position: relative;
  overflow: visible;
}

/* Split view: constrain comment widgets to their respective side.
   In colspan=2 cells (insert/delete lines), the td already covers one side â€” fill it.
   In colspan=4 cells (normal lines), we need to position within the full-width cell. */
.diff-widget-content .split-widget-old,
.diff-widget-content .split-widget-new {
  width: 100%;
}

td[colspan="4"].diff-widget-content .split-widget-old {
  width: 50%;
}

td[colspan="4"].diff-widget-content .split-widget-new {
  width: 50%;
  margin-left: 50%;
}

/* Expand context decoration rows */
.diff-decoration {
  background-color: transparent;
}

.diff-decoration-gutter {
  @apply bg-gray-900;
  border-right: 1px solid #374151;
}

.diff-decoration-content {
  background-color: transparent;
}
